# migration-relation tests

FEATURE: migration 
background:
 configure loadFKs = true
thenType: struct

# -- start chain ---
---
title: 1to1-1
chainNextTest:true
given:
 type Customer struct {id int primaryKey serial, wid int } end
 type Address struct {id int primaryKey serial } end

when:
  insert Customer { wid:33 }
  let x = Customer[1]
then:
value:a:Customer {
 vid:1
 vwid:33
}

---
title: 1to1-1 - add rel
given:
 type Customer struct {id int primaryKey serial, wid int, relation addr Address optional parent one  } end
 type Address struct {id int primaryKey serial, relation cust Customer optional one } end

when:
  insert Customer { wid:34}
  let x = Customer[2]
then:
value:a:Customer {
 vid:2
 vwid:34
}

